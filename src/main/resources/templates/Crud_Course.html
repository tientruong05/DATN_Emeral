<!DOCTYPE html>
<html th:replace="~{/layout::view(~{::title}, ~{::body}, ~{::style})}" xmlns:th="http://www.thymeleaf.org" lang="vi">

<head>
  <meta charset="UTF-8">
  <title>Qu·∫£n L√Ω Kh√≥a H·ªçc - EDU102</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background-color: #f7f9fc;
      color: #333;
    }
    .manage-courses-container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 1rem;
    }
    .manage-courses-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .manage-courses-header h1 {
      color: #002855;
      font-size: 2rem;
    }
    .add-course-btn {
      background-color: #002855;
      color: white;
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    
    .import-excel-btn, .export-excel-btn {
            background-color: #002855;
            color: white;
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
        }

        .import-excel-btn:hover, .export-excel-btn:hover {
            background-color: #001f42;
        }

        .import-excel-btn {
            background-color: #17a2b8;
        }

        .import-excel-btn:hover {
            background-color: #138496;
        }

        .export-excel-btn {
            background-color: #28a745;
        }

        .export-excel-btn:hover {
            background-color: #218838;
        }
    
    
    .add-course-btn:hover {
      background-color: #001f42;
    }
    .courses-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .courses-table th, .courses-table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    .courses-table th {
      background-color: #002855;
      color: white;
      text-transform: uppercase;
      font-size: 0.85rem;
    }
    
    /* CƒÉn gi·ªØa c·ªôt h√†nh ƒë·ªông */
    .courses-table th:last-child,
    .courses-table td:last-child {
      text-align: center;
    }
	
    .course-name {
      color: #002855;
      font-weight: 500;
    }
    .course-price {
      font-weight: 500;
    }
    .course-status.active {
      color: #28a745;
    }
    .course-status.inactive {
      color: #dc3545;
    }
    .action-buttons {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      align-items: center;
    }
    .btn-action {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      border: none;
      cursor: pointer;
      text-decoration: none;
    }
    .edit-btn {
      background-color: #ff6b00;
      color: white;
    }
    .edit-btn:hover {
      background-color: #e65c00;
    }
    .content-btn {
      background-color: #007bff;
      color: white;
    }
    .content-btn:hover {
      background-color: #0056b3;
    }
    .delete-btn {
      background-color: #dc3545;
      color: white;
    }
    .delete-btn:hover {
      background-color: #c82333;
    }
    
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
    }
    
    /* */.modal-content {
      background-color: white;
      padding: 0;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem;
      border-bottom: 1px solid #eee;
    }
    .modal-footer {
      padding: 1.5rem;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
    }
     
     .modal-content {
    background-color: white;
    padding: 0; /* Gi·ªØ nguy√™n padding 0 ƒë·ªÉ body c·ªßa modal qu·∫£n l√Ω padding */
    border-radius: 12px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);

    /* --- B·∫Øt ƒë·∫ßu ph·∫ßn th√™m/s·ª≠a --- */
    max-height: 90vh; /* Gi·ªõi h·∫°n chi·ªÅu cao t·ªëi ƒëa c·ªßa modal, v√≠ d·ª• 90% chi·ªÅu cao viewport */
    display: flex; /* S·ª≠ d·ª•ng flexbox ƒë·ªÉ c·∫•u tr√∫c header, body, footer */
    flex-direction: column; /* X·∫øp c√°c ph·∫ßn t·ª≠ theo c·ªôt */
    overflow: hidden; /* ·∫®n overflow ·ªü c·∫•p ƒë·ªô modal-content ƒë·ªÉ modal-body c√≥ th·ªÉ cu·ªôn */
    /* --- K·∫øt th√∫c ph·∫ßn th√™m/s·ª≠a --- */
}

.modal-body {
    padding: 1.5rem;
    /* --- B·∫Øt ƒë·∫ßu ph·∫ßn th√™m/s·ª≠a --- */
    flex-grow: 1; /* Cho ph√©p modal-body m·ªü r·ªông ƒë·ªÉ l·∫•p ƒë·∫ßy kh√¥ng gian c√≤n l·∫°i */
    overflow-y: auto; /* Th√™m thanh cu·ªôn d·ªçc khi n·ªôi dung tr√†n */
    /* --- K·∫øt th√∫c ph·∫ßn th√™m/s·ª≠a --- */
}

/* Gi·ªØ nguy√™n c√°c style kh√°c c·ªßa modal-header v√† modal-footer */
.modal-header {
    flex-shrink: 0; /* NgƒÉn header co l·∫°i */
    padding: 1.5rem;
    border-bottom: 1px solid #eee;
}

.modal-footer {
    flex-shrink: 0; /* NgƒÉn footer co l·∫°i */
    padding: 1.5rem;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
}
    .modal-header h2 {
      color: #002855;
      margin: 0;
    }
    
    .close-btn {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .close-btn:hover {
      color: #000;
    }
    
    .modal-body {
      padding: 1.5rem;
    }
    
    .form-group {
      margin-bottom: 1rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #333;
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1rem;
    }
    .form-group textarea {
            padding: 0.5rem;
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: #002855;
    }
    
    
    
    .cancel-btn, .save-btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
    }
    
	.cancel-btn {
	  background-color: #dc3545;
	  color: white;
	}
	.cancel-btn:hover {
	  background-color: #c82333;
	}
    
    .save-btn {
      background-color: #002855;
      color: white;
    }
    
    .save-btn:hover {
      background-color: #001f42;
    }
    
    .delete-modal-content {
      background-color: white;
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      text-align: center;
    }
    
    .delete-modal-content p {
      margin-bottom: 1.5rem;
      color: #333;
      font-size: 1.1rem;
    }
    /* Ph·∫ßn avatar */
        .profile-avatar {
            flex: 1;
        }
    
        .avatar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            position: relative;
        }
    
        .avatar-icon {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 3px solid #e6eaf0;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
    
        .user-icon {
            font-size: 4rem;
            color: #95a5a6;
        }
    
        .avatar-upload {
            width: 100%;
            text-align: center;
        }
    
        .upload-btn {
            background-color: #f8f9fa;
            color: #1a3b5d;
            border: 1px solid #e6eaf0;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-block;
            text-decoration: none;
        }
    
        .upload-btn:hover {
            background-color: #e6eaf0;
        }
        
        /* Pagination */
        .pagination-section {
            display: flex;
            justify-content: center;
            margin-top: 3rem;
        }

        .pagination {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pagination button {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background-color: white;
            color: #333;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination button:hover {
            background-color: #002855;
            color: white;
            border-color: #002855;
        }

        .pagination button.active {
            background-color: #002855;
            color: white;
            border-color: #002855;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination button:disabled:hover {
            background-color: white;
            color: #333;
            border-color: #ddd;
        }
  </style>
</head>
<body>
  <div class="manage-courses-container">
    <div class="manage-courses-header">
      <h1>Qu·∫£n l√Ω kh√≥a h·ªçc</h1>
      <div class="button-group">
		<button class="add-course-btn" onclick="openModal('add-course-modal')">Th√™m kh√≥a h·ªçc</button>
        <button class="import-excel-btn" onclick="openModal('import-course-modal')">Nh·∫≠p Excel</button>
        <a th:href="@{/Crud_Course/export}" class="export-excel-btn">Xu·∫•t Excel</a>
      </div>
      
    </div>

    <table class="courses-table">
      <thead>
        <tr>
        <th>STT</th>
          <th>T√™n kh√≥a h·ªçc</th>
          <th>ƒêi·ªÉm ƒë·∫°t</th>
          <th>Danh m·ª•c</th>
          
          <th>Ph·∫ßn trƒÉm gi·∫£m</th>
          <th>Gi√°</th>
          <th>S·ªë l∆∞·ª£ng b√†i h·ªçc</th>
          <th>·∫¢nh ƒë·∫°i di·ªán</th>
          <th>Tr·∫°ng th√°i</th>
          <th>H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
  <tr th:each="course, iterStat : ${courses}">
    <td th:text="${iterStat.index + currentPage * pageSize + 1}"></td>
    <td class="course-name" th:text="${course.ten_khoa_hoc}"></td>
    <td th:text="${course.diem_dat}"></td>
    <td th:text="${course.category.tenDanhMuc}"></td>
    
   <td th:text="${course.discountPercentage != null ? course.discountPercentage + '%' : ''}"></td>
   <!-- <td th:text="${#numbers.formatDecimal(course.getDiscountedPrice, 0, 'COMMA', 0, 'POINT') + ' VND'}"></td> -->
   
   <td>
    <span th:if="${course.discounted}" style="color: red; font-weight: bold;">
        
        
        <span style="text-decoration: line-through; color: gray;"
              th:text="${#numbers.formatDecimal(course.gia_tien, 0, 'COMMA', 0, 'POINT')} + ' VND'">
        </span>
        <br>
        <span th:text="${#numbers.formatDecimal(course.discountedPrice, 0, 'COMMA', 0, 'POINT')} + ' VND'"></span>
    </span>
    <span th:if="${!course.discounted}">
        <span th:text="${#numbers.formatDecimal(course.gia_tien, 0, 'COMMA', 0, 'POINT')} + ' VND'"></span>
    </span>
</td>
   
    <!-- 
    <td th:text="${course.gia_tien != null ? #numbers.formatDecimal(course.gia_tien, 0, 'COMMA', '.', '') + ' VND' : '0 VND'}"></td>
    
    <td th:text="${#numbers.formatDecimal(course.gia_tien, 0, 'COMMA', '.', '') + ' VND'}"></td> -->
    <td th:text="${#lists.size(course.videos)} + ' b√†i'"></td>
    <td>
    <img th:if="${course.anh_dai_dien != null}" 
     th:src="@{/upload/{img}(img=${course.anh_dai_dien})}" 
     alt="·∫¢nh ƒë·∫°i di·ªán" width="80" height="60">

 <!--     
      <img th:src="@{'/uploads/' + ${course.anh_dai_dien}}" alt="·∫¢nh ƒë·∫°i di·ªán" width="80" height="60">-->
    </td>
    <td th:text="${course.status ? 'Ho·∫°t ƒë·ªông' : 'Kh√¥ng ho·∫°t ƒë·ªông'}"
    class="course-status"
    th:classappend="${course.status} ? ' active' : ' inactive'">
</td>


    <td>
      <div class="action-buttons">
        <!-- N√∫t ch·ªânh s·ª≠a -->
         <!-- data-bs-toggle="modal" data-bs-target="#edit-course-modal" -->
        <button class="btn-action edit-btn" 
              
               onclick="openEditCourseModal(this)"
              th:attr="data-id=${course.ID_khoa_hoc},
                       data-title=${course.ten_khoa_hoc},
                       data-category=${course.category.id},
                       data-price=${course.gia_tien},
                       data-point=${course.diem_dat},
                       data-description=${course.mo_ta},
                       data-status=${course.status},
                       data-anh_dai_dien=${course.anh_dai_dien}"
                title="Ch·ªânh s·ª≠a">
          <i class="fas fa-edit"></i>
        </button>

        <!-- N√∫t n·ªôi dung kh√≥a h·ªçc -->
        <a th:href="@{'/course-content/' + ${course.ID_khoa_hoc}}"
		   class="btn-action content-btn"
		   title="N·ªôi dung">
		  <i class="fas fa-book"></i>
		</a>

        <!-- N√∫t x√≥a -->
        <!-- N√∫t m·ªü modal x√°c nh·∫≠n x√≥a -->
<button class="btn-action delete-btn"
        onclick="openDeleteModal(this)"
        	 th:attr="data-id=${course.ID_khoa_hoc}"
        title="X√≥a">
  <i class="fas fa-trash"></i>
</button>
      </div>
    </td>
  </tr>
</tbody>

      <!-- 
      <tbody>
        <tr>
          <td class="course-name">Ph√¢n t√≠ch d·ªØ li·ªáu v·ªõi Python</td>
          <td>C√¥ng ngh·ªá</td>
          <td class="course-price">7,000 VND</td>
          <td>12 b√†i</td>
          <td class="course-status inactive">Kh√¥ng ho·∫°t ƒë·ªông</td>
          <td>
            <div class="action-buttons">
              <button class="btn-action edit-btn" onclick="openModal('edit-course-modal')" title="Ch·ªânh s·ª≠a"><i class="fas fa-edit"></i></button>
              <a href="course-content.html?courseId=3" class="btn-action content-btn" title="N·ªôi dung"><i class="fas fa-book"></i></a>
              <button class="btn-action delete-btn" onclick="openModal('delete-course-modal')" title="X√≥a"><i class="fas fa-trash"></i></button>
            </div>
          </td>
        </tr>
      </tbody> -->
    </table>
    <!-- Pagination -->
        <div class="pagination-section" th:if="${totalPages > 1}">
            <div class="pagination">
                <button th:disabled="${currentPage == 0}" th:onclick= "'window.location.href=\'' + @{/Crud_Course(page=${currentPage - 1}, size=${pageSize})} + '\''" id="prev-btn">‚Äπ Tr∆∞·ªõc</button>
                <button th:each="i : ${#numbers.sequence(0, totalPages - 1)}" 
                th:onclick="'window.location.href=\'' + @{/Crud_Course( page=${i}, size=${pageSize})} + '\''" 
                th:classappend="${i == currentPage} ? 'active'" 
                th:style="${i < totalPages} ? 'display: block' : 'display: none'" 
                th:text="${i + 1}"></button>
                <!-- 
                <button onclick="changePage(1)" class="active">1</button>
                <button onclick="changePage(2)">2</button>
                <button onclick="changePage(3)">3</button> -->
                <button id="next-btn" th:onclick="'window.location.href=\'' + @{/Crud_Course( page=${currentPage + 1}, size=${pageSize})} + '\''" th:disabled="${currentPage == totalPages - 1}" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">Sau ‚Ä∫</button>
            </div>
        </div>
  </div>
  
  <!-- Add Course Modal -->
  <div class="modal" id="add-course-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Th√™m kh√≥a h·ªçc m·ªõi</h2>
        <button class="close-btn" onclick="closeModal('add-course-modal')">‚úï</button>
      </div>
      <div class="modal-body">
        <form id="add-course-form"
      th:action="@{/Crud_Course/add}"
      th:object="${course}"
      method="post"
      enctype="multipart/form-data">

          <div class="form-group">
            <label for="add-course-name">T√™n kh√≥a h·ªçc</label>
            <input type="text" id="add-course-name" placeholder="Nh·∫≠p t√™n kh√≥a h·ªçc" th:field="*{ten_khoa_hoc}" required>
          </div>
          <div class="form-group">
            <label for="add-category-description">M√¥ t·∫£</label>
            <textarea id="add-category-description" th:field="*{mo_ta}"></textarea>
          </div>
          <div class="form-group">
            <label for="add-course-point">ƒêi·ªÉm ƒë·∫°t</label>
            <input type="number" id="add-course-point" placeholder="Nh·∫≠p ƒëi·ªÉm ƒë·ªÉ ƒë·∫≠u kh√≥a h·ªçc" th:field="*{diem_dat}" min="0" max="10" required>
          </div>
          <div class="form-group">
            <label for="add-course-category">Danh m·ª•c</label>
            <select id="add-course-category" th:field="*{category.id}">
            <option value="">Ch·ªçn danh m·ª•c</option>
                        <option th:each="category : ${categories}" 
                                th:value="${category.id}" 
                                th:text="${category.tenDanhMuc}" >
                                <!-- th:selected="${category.tenDanhMuc == selectedCategory}" -->
                                
                        </option>
            </select>
            <!-- <select id="edit-course-category" required>
              <option value="">Ch·ªçn danh m·ª•c</option>
              <option value="finance">T√†i ch√≠nh</option>
              <option value="technology">C√¥ng ngh·ªá</option>
              <option value="business">Kinh doanh</option>
            </select> -->
          </div>
          <div class="form-group">
            <label for="add-course-price">Gi√° (VND)</label>
            <input type="number" id="add-course-price" placeholder="Nh·∫≠p gi√° kh√≥a h·ªçc"  th:field="*{gia_tien}" min="1000" required>
          </div>
           
                 <div class="profile-avatar">
                <div class="avatar-container">
                    <div class="avatar-icon">
                        <i class="user-icon">üë§</i>
                    </div>
                    <div class="avatar-upload">
                        <input type="file" id="avatar-file"  name="fileAnhDaiDien" accept="image/*" style="display: none;">
                        <label for="avatar-file" class="upload-btn">Ch·ªçn ·∫£nh</label>
                    </div>
                </div>
            </div>
                <div class="form-group">
                    <label for="add-category-status">Tr·∫°ng th√°i</label>
                    <select id="add-category-status"  th:field="*{status}" required>
                        <option value="true">Ho·∫°t ƒë·ªông</option>
                        <option value="false">Kh√¥ng ho·∫°t ƒë·ªông</option>
                    </select>
                </div>
                <div class="modal-footer">
        <button class="cancel-btn" onclick="closeModal('add-course-modal')">H·ªßy</button>
        <button class="save-btn" type="submit">Th√™m</button>
      </div>
        </form>
      </div>
      
    </div>
  </div>

  <!-- Edit Course Modal -->
<div class="modal" id="edit-course-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Ch·ªânh s·ª≠a kh√≥a h·ªçc</h2>
      <button class="close-btn" onclick="closeModal('edit-course-modal')">‚úï</button>
    </div>
    <div class="modal-body">
      <form id="edit-course-form"
            th:action="@{/Crud_Course/update}"
            th:object="${course}"
            method="post"
            enctype="multipart/form-data">

        <input type="hidden" name="ID_khoa_hoc" id="edit-course-id" th:field="*{ID_khoa_hoc}">

        <div class="form-group">
          <label for="edit-course-name">T√™n kh√≥a h·ªçc</label>
          <input type="text" id="edit-course-name" th:field="*{ten_khoa_hoc}" placeholder="Nh·∫≠p t√™n kh√≥a h·ªçc" required>
        </div>

        <div class="form-group">
          <label for="edit-course-description">M√¥ t·∫£</label>
          <textarea id="edit-course-description" th:field="*{mo_ta}" placeholder="Nh·∫≠p m√¥ t·∫£ kh√≥a h·ªçc"></textarea>
        </div>

        <div class="form-group">
          <label for="edit-course-point">ƒêi·ªÉm ƒë·∫°t</label>
          <input type="number" id="edit-course-point" th:field="*{diem_dat}" min="0" max="10" required>
        </div>

        <div class="form-group">
          <label for="edit-course-category">Danh m·ª•c</label>
          <select id="edit-course-category" th:field="*{category.id}" required>
            <option value="">-- Ch·ªçn danh m·ª•c --</option>
            <option th:each="cat : ${categories}"
                    th:value="${cat.id}"
                    th:text="${cat.tenDanhMuc}">
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="edit-course-price">Gi√° (VND)</label>
          <input type="number" id="edit-course-price" th:field="*{gia_tien}" min="1000" required>
        </div>

        <div class="form-group">
          <label>·∫¢nh ƒë·∫°i di·ªán</label>
          <div class="avatar-container">
            <div class="current-avatar">
              <img th:src="@{/upload/{img}(img=${course.anh_dai_dien})}" alt="·∫¢nh hi·ªán t·∫°i" style="max-height: 100px;">
            </div>
            <input type="hidden" name="oldImage" th:value="${course.anh_dai_dien}">
            <input type="file" id="avatar-file" name="imageFile" accept="image/*">
            <label for="avatar-file" class="upload-btn">Ch·ªçn ·∫£nh m·ªõi</label>
          </div>
        </div>

        <div class="form-group">
          <label for="edit-course-status">Tr·∫°ng th√°i</label>
          <select id="edit-course-status" th:field="*{status}" required>
            <option th:value="true" th:selected="${course.status} == true">Ho·∫°t ƒë·ªông</option>
            <option th:value="false" th:selected="${course.status} == false">Kh√¥ng ho·∫°t ƒë·ªông</option>
          </select>
        </div>

        <div class="modal-footer">
          <button class="cancel-btn" type="button" onclick="closeModal('edit-course-modal')">H·ªßy</button>
          <button class="save-btn" type="submit">L∆∞u</button>
        </div>
      </form>
    </div>
  </div>
</div>


  <!-- Modal x√°c nh·∫≠n x√≥a -->
<div class="modal" id="delete-course-modal">
  <div class="delete-modal-content">
    <form id="deleteCourseForm" method="get">
      <p>X√≥a kh√≥a h·ªçc n√†y s·∫Ω kh√¥ng th·ªÉ kh√¥i ph·ª•c. B·∫°n c√≥ ch·∫Øc ch·∫Øn?</p>
      <div class="modal-footer">
        <button type="button" class="cancel-btn" onclick="closeModal('delete-course-modal')">H·ªßy</button>
        <button type="submit" class="delete-btn">X√≥a</button>
      </div>
    </form>
  </div>
</div>
<!-- Import Excel Modal -->
        <div class="modal" id="import-course-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Nh·∫≠p danh m·ª•c t·ª´ Excel</h2>
                    <button class="close-btn" onclick="closeModal('import-course-modal')">‚úï</button>
                </div>
                <div class="modal-body">
                    <form th:action="@{/Crud_Course/import}" method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="import-file">Ch·ªçn file Excel</label>
                            <input type="file" id="import-file" name="file" accept=".xlsx,.xls" required>
                            <div class="error" id="error-import-file"></div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="cancel-btn" onclick="closeModal('import-course-modal')">H·ªßy</button>
                            <button type="submit" class="save-btn">Nh·∫≠p</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
  
  <!-- JavaScript for Modal -->
  <script>
 /* function openDeleteModal(courseId) {
	  const id = button.getAttribute('data-id');
	  document.getElementById('edit-course-id').value = id;
	  openModal('delete-course-modal');
	  }*/
    function openModal(modalId) {
      document.getElementById(modalId).style.display = 'flex';
    }
    function openDeleteModal(button) {
        const id = button.getAttribute('data-id');
        const form = document.getElementById('deleteCourseForm');
        form.action = `/Crud_Course/delete/${id}`;
        openModal('delete-course-modal');
      }
   /*function openModal(modalId) {
  const modal = document.getElementById(modalId);
  if (!modal) return;

  modal.style.display = 'flex'; // d√πng flex ƒë·ªÉ hi·ªÉn th·ªã modal trung t√¢m d·ªÖ h∆°n

  if (!document.querySelector('.modal-backdrop')) {
    const backdrop = document.createElement('div');
    backdrop.classList.add('modal-backdrop', 'show');
    document.body.appendChild(backdrop);
  }
}*/

function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'none';

  const backdrop = document.querySelector('.modal-backdrop');
  if (backdrop) backdrop.remove();
}



    //function closeModal(modalId) {
//      document.getElementById(modalId).style.display = 'none';
  //  }

    // Close modal when clicking outside
    window.onclick = function(event) {
      const addModal = document.getElementById('add-course-modal');
      const editModal = document.getElementById('edit-course-modal');
      const deleteModal = document.getElementById('delete-course-modal');
      
      if (event.target === addModal) {
        addModal.style.display = 'none';
      }
      if (event.target === editModal) {
        editModal.style.display = 'none';
      }
      if (event.target === deleteModal) {
        deleteModal.style.display = 'none';
      }
    };

    // Function to handle adding new course
    function addCourse() {

      
      if (courseName && courseCategory && coursePrice) {
        // TODO: Call backend API to add course
        console.log('Th√™m kh√≥a h·ªçc:', {
          name: courseName,
          category: courseCategory,
          price: coursePrice
        });
        
        // Close modal and reset form
        closeModal('add-course-modal');
        document.getElementById('add-course-form').reset();
        
        // TODO: Refresh course list or add new row to table
        alert('ƒê√£ th√™m kh√≥a h·ªçc th√†nh c√¥ng!');
      } else {
        alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
      }
    }
    function openEditCourseModal(button) {
        const id = button.getAttribute('data-id');
        const title = button.getAttribute('data-title');
        const category = button.getAttribute('data-category');
        const price = button.getAttribute('data-price');
        const point = button.getAttribute('data-point');
        const description = button.getAttribute('data-description');
        const status = button.getAttribute('data-status');
        const anhDaiDien = button.getAttribute('data-anh_dai_dien'); // th√™m thu·ªôc t√≠nh ·∫£nh

        document.getElementById('edit-course-id').value = id;
        document.getElementById('edit-course-name').value = title;
        document.getElementById('edit-course-description').value = description;
        document.getElementById('edit-course-point').value = point;
        document.getElementById('edit-course-category').value = category;
        document.getElementById('edit-course-price').value = price;
        document.getElementById('edit-course-status').value = status;

        // Set ·∫£nh ƒë·∫°i di·ªán (n·∫øu c√≥)
        const avatarImg = document.querySelector("#edit-course-modal .current-avatar img");
        if (anhDaiDien && anhDaiDien.trim() !== "") {
            avatarImg.src = "/upload/" + anhDaiDien;
        } else {
            avatarImg.src = "/upload/default.png"; // ho·∫∑c ·∫£nh m·∫∑c ƒë·ªãnh
        }

        // Set oldImage hidden input
        const oldImageInput = document.querySelector("#edit-course-modal input[name='oldImage']");
        if(oldImageInput){
            oldImageInput.value = anhDaiDien || "";
        }

        openModal('edit-course-modal');
    }


    // Function to handle updating course
    function updateCourse() {
      
      if (courseName && courseCategory && coursePrice) {
        // TODO: Call backend API to update course
        console.log('C·∫≠p nh·∫≠t kh√≥a h·ªçc:', {
          name: courseName,
          category: courseCategory,
          price: coursePrice
        });
        
        // Close modal and reset form
        closeModal('edit-course-modal');
        document.getElementById('edit-course-form').reset();
        
        // TODO: Refresh course list or update existing row
        alert('ƒê√£ c·∫≠p nh·∫≠t kh√≥a h·ªçc th√†nh c√¥ng!');
      } else {
        alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
      }
    }

    // Function to populate edit form with course data
    function editCourse(courseId, courseName, courseCategory, coursePrice) {
      // Populate form fields
      document.getElementById('edit-course-name').value = courseName;
      document.getElementById('edit-course-category').value = courseCategory;
      document.getElementById('edit-course-price').value = coursePrice;
      
      // Store course ID for update
      document.getElementById('edit-course-form').setAttribute('data-course-id', courseId);
      
      // Open modal
      openModal('edit-course-modal');
    }
  </script>
</body>
</html>